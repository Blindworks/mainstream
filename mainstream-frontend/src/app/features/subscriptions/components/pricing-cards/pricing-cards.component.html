<div class="pricing-cards">
  <div class="pricing-grid">
    @for (plan of plans; track plan.id) {
      <div class="pricing-card-wrapper" [class.highlighted]="plan.highlighted">
        @if (plan.popular) {
          <div class="popular-ribbon">
            <span>{{ 'pricing.popular' | transloco }}</span>
          </div>
        }

        <mat-card [class.current]="isCurrentPlan(plan.id)" class="pricing-card">
          <div class="card-content">
            <div class="plan-header">
              <h2 class="plan-name">{{ plan.name }}</h2>
              @if (isCurrentPlan(plan.id)) {
                <mat-chip class="current-chip">
                  <mat-icon>check</mat-icon>
                  {{ 'pricing.currentPlan' | transloco }}
                </mat-chip>
              }
            </div>

            <div class="price-section">
              <div class="price">
                <span class="currency">{{ plan.currency }}</span>
                <span class="amount">{{ plan.price }}</span>
              </div>
              <div class="price-interval">
                {{ plan.interval === 'month' ? ('pricing.perMonth' | transloco) : ('pricing.perYear' | transloco) }}
              </div>
              @if (plan.price === 0) {
                <div class="price-badge">{{ 'pricing.freeForever' | transloco }}</div>
              }
            </div>

            <div class="features">
              <ul>
                @for (feature of plan.features; track $index) {
                  <li>
                    <mat-icon class="feature-icon">check_circle</mat-icon>
                    <span class="feature-text">{{ feature }}</span>
                  </li>
                }
              </ul>
            </div>
          </div>

          <div class="card-actions">
            @if (isCurrentPlan(plan.id)) {
              <button mat-stroked-button disabled class="action-button current">
                {{ 'pricing.alreadySubscribed' | transloco }}
              </button>
            } @else {
              <button
                mat-flat-button
                color="primary"
                (click)="onSelectPlan(plan)"
                class="action-button"
                [class.premium]="plan.highlighted">
                {{ plan.buttonText || ('pricing.select' | transloco) }}
              </button>
            }
          </div>
        </mat-card>
      </div>
    }
  </div>
</div>
